# Intent: LainClaw DM 配对鉴权能力

## 背景与动机（Why）
LainClaw 当前支持飞书 DM 入口并直接透传到 `runAsk`，未对 DM 发送方做“配对”鉴权。OpenClaw 已有成熟的配对体系（审批码、按账号 allowFrom、命令行审批），可复用其设计实现。为避免公开 DM 被任意滥用，需引入配对机制，提升安全边界。

## 目标（Goals）
1. 在 LainClaw 的飞书 DM 流程中支持 `pairing` 策略。
2. 在未配对发送方进入 `pairing` 流程时阻断业务问答。
3. 提供配对请求持久化与管理能力（列出待审批项/批准/移除）。
4. 保持现有 DM 正常流程可用，并确保默认行为尽量兼容现状。

## 非目标（Non-Goals）
1. 不在本阶段扩展到 Telegram/Slack 等其他渠道。
2. 不改造 OpenClaw 的现有配对模型，只做引用与对齐。
3. 不重写现有告警/审计链路；不引入新的跨服务协作。
4. 不做 UI 页面化配对管理，CLI 即为首发管理面。

## 验收标准（Acceptance Criteria）
1. 当 DM 策略为 `pairing` 时，未配对发送方不能进入 `runAsk` 流程。
2. 可在配置中开启/关闭配对策略，且默认不影响现有运行语义（需在文档中明确）。
3. 可从 CLI 查看、批准/移除配对关系；批准后对应 sender 在存活窗口内可继续访问。
4. 配对记录按账号隔离、支持过期清理与幂等判断。
5. 至少在关键边界场景补充测试：审批码/重复生成、TTL 过期、按账号复用与冲突。
